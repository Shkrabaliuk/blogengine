# üîí –ë–µ–∑–ø–µ–∫–∞

## –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ –∑–∞—Ö–æ–¥–∏ –±–µ–∑–ø–µ–∫–∏

### 1. –ê–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è —Ç–∞ —Å–µ—Å—ñ—ó
- ‚úÖ Password hashing –∑ `password_hash()` (bcrypt)
- ‚úÖ –ë–µ–∑–ø–µ—á–Ω–µ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –ø–∞—Ä–æ–ª—ñ–≤ —á–µ—Ä–µ–∑ `password_verify()`
- ‚úÖ –°–µ—Å—ñ—ó –∑ `session_start()`
- ‚úÖ Logout –∑ –ø–æ–≤–Ω–∏–º –∑–Ω–∏—â–µ–Ω–Ω—è–º —Å–µ—Å—ñ—ó

### 2. CSRF (Cross-Site Request Forgery)
- ‚úÖ –£–Ω—ñ–∫–∞–ª—å–Ω—ñ —Ç–æ–∫–µ–Ω–∏ –¥–ª—è –∫–æ–∂–Ω–æ—ó —Å–µ—Å—ñ—ó
- ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–æ–∫–µ–Ω—ñ–≤ —É –≤—Å—ñ—Ö POST —Ñ–æ—Ä–º–∞—Ö
- ‚úÖ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `hash_equals()` –¥–ª—è –±–µ–∑–ø–µ—á–Ω–æ–≥–æ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è

### 3. XSS (Cross-Site Scripting)
- ‚úÖ –í—Å—ñ –≤–∏–≤–æ–¥–∏ –µ–∫—Ä–∞–Ω—É—é—Ç—å—Å—è —á–µ—Ä–µ–∑ `htmlspecialchars()`
- ‚úÖ –§—É–Ω–∫—Ü—ñ—è-—Ö–µ–ª–ø–µ—Ä `e()` –¥–ª—è –∫–æ—Ä–æ—Ç—à–æ–≥–æ –∑–∞–ø–∏—Å—É
- ‚úÖ `ENT_QUOTES` –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É –∞—Ç—Ä–∏–±—É—Ç—ñ–≤
- ‚úÖ `nl2br()` –¥–ª—è –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤ –∑—ñ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è–º –ø–µ—Ä–µ–Ω–æ—Å—ñ–≤

### 4. SQL Injection
- ‚úÖ –í–∏–∫–ª—é—á–Ω–æ PDO Prepared Statements
- ‚úÖ –ù—ñ—è–∫–∏—Ö –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü—ñ–π SQL –∑–∞–ø–∏—Ç—ñ–≤
- ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω—ñ –∑–∞–ø–∏—Ç–∏ –¥–ª—è –≤—Å—ñ—Ö –≤–≤–æ–¥—ñ–≤

### 5. –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤
- ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ MIME —Ç–∏–ø—ñ–≤ —á–µ—Ä–µ–∑ `finfo`
- ‚úÖ –ë—ñ–ª–∏–π —Å–ø–∏—Å–æ–∫ –¥–æ–∑–≤–æ–ª–µ–Ω–∏—Ö —Ç–∏–ø—ñ–≤
- ‚úÖ –õ—ñ–º—ñ—Ç —Ä–æ–∑–º—ñ—Ä—É (10MB)
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –±–µ–∑–ø–µ—á–Ω–∏—Ö —ñ–º–µ–Ω —Ñ–∞–π–ª—ñ–≤
- ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–æ–º–∏–ª–æ–∫ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
- ‚úÖ –¢—ñ–ª—å–∫–∏ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

### 6. –ó–∞—Ö–∏—Å—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ–π
- ‚úÖ `.htaccess` –±–ª–æ–∫—É—î –¥–æ—Å—Ç—É–ø –¥–æ `/system/` —Ç–∞ `/data/`
- ‚úÖ –ó–∞–±–æ—Ä–æ–Ω–∞ –¥–æ—Å—Ç—É–ø—É –¥–æ `.db`, `.sql`, `.log` —Ñ–∞–π–ª—ñ–≤
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ñ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø—É (777 —Ç—ñ–ª—å–∫–∏ –¥–ª—è uploads —Ç–∞ data)

### 7. –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤–≤–æ–¥—É
- ‚úÖ `trim()` –¥–ª—è –≤—Å—ñ—Ö —Ç–µ–∫—Å—Ç–æ–≤–∏—Ö –ø–æ–ª—ñ–≤
- ‚úÖ `maxlength` –¥–ª—è –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤ (1000 —Å–∏–º–≤–æ–ª—ñ–≤)
- ‚úÖ `maxlength` –¥–ª—è —ñ–º–µ–Ω (50 —Å–∏–º–≤–æ–ª—ñ–≤)
- ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ –ø–æ—Ä–æ–∂–Ω—ñ –ø–æ–ª—è
- ‚úÖ –û—á–∏—â–µ–Ω–Ω—è URL –≤—ñ–¥ –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏—Ö —Å–∏–º–≤–æ–ª—ñ–≤

### 8. HTTP Headers
–†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –¥–æ–¥–∞—Ç–∏ –≤ `.htaccess`:
```apache
# –î–æ–¥–∞–π—Ç–µ —Ü—ñ —Ä—è–¥–∫–∏ –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏
Header always set X-Content-Type-Options "nosniff"
Header always set X-Frame-Options "SAMEORIGIN"
Header always set X-XSS-Protection "1; mode=block"
Header always set Referrer-Policy "strict-origin-when-cross-origin"
```

## –©–æ –ù–ï —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ (–∞–ª–µ –±–∞–∂–∞–Ω–æ)

### 1. Rate Limiting
‚ùå –ù–µ–º–∞—î –æ–±–º–µ–∂–µ–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —Å–ø—Ä–æ–± –≤—Ö–æ–¥—É
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: –î–æ–¥–∞–π—Ç–µ –ø—ñ—Å–ª—è 5 –Ω–µ–≤–¥–∞–ª–∏—Ö —Å–ø—Ä–æ–± - –±–ª–æ–∫—É–≤–∞–Ω–Ω—è –Ω–∞ 15 —Ö–≤–∏–ª–∏–Ω

### 2. Email –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è
‚ùå –ö–æ–º–µ–Ω—Ç–∞—Ä—ñ –±–µ–∑ email –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è
**–†—ñ—à–µ–Ω–Ω—è**: –î–æ–¥–∞–π—Ç–µ captcha –∞–±–æ Akismet –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É –≤—ñ–¥ —Å–ø–∞–º—É

### 3. Content Security Policy
‚ùå –ù–µ–º–∞—î CSP headers
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: –î–æ–¥–∞–π—Ç–µ –≤ `.htaccess`:
```apache
Header set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' ajax.googleapis.com cdnjs.cloudflare.com;"
```

### 4. HTTPS
‚ùå –ù–µ —Ñ–æ—Ä—Å—É—î—Ç—å—Å—è HTTPS (–∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —Ö–æ—Å—Ç–∏–Ω–≥—É)
**–†—ñ—à–µ–Ω–Ω—è**: –î–æ–¥–∞–π—Ç–µ –≤ `.htaccess`:
```apache
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
```

### 5. –î–≤–æ—Ñ–∞–∫—Ç–æ—Ä–Ω–∞ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è
‚ùå –¢—ñ–ª—å–∫–∏ –ø–∞—Ä–æ–ª—å
**–î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω—É**: –†–æ–∑–≥–ª—è–Ω—å—Ç–µ –¥–æ–¥–∞–≤–∞–Ω–Ω—è 2FA

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –ø–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—é

### php.ini
```ini
; –í–∏–º–∫–Ω—É—Ç–∏ –ø–æ–∫–∞–∑ –ø–æ–º–∏–ª–æ–∫ –≤ –ø—Ä–æ–¥–∞–∫—à–Ω—ñ
display_errors = Off
log_errors = On
error_log = /path/to/php-error.log

; –û–±–º–µ–∂–µ–Ω–Ω—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
upload_max_filesize = 10M
post_max_size = 10M

; –°–µ—Å—ñ—ó
session.cookie_httponly = 1
session.cookie_secure = 1  # –Ø–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è HTTPS
session.use_strict_mode = 1
```

### –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è —Å–∏–ª—å–Ω–æ–≥–æ –ø–∞—Ä–æ–ª—è

```php
<?php
// –ì–µ–Ω–µ—Ä—É—î–º–æ –≤–∏–ø–∞–¥–∫–æ–≤–∏–π –ø–∞—Ä–æ–ª—å
$password = bin2hex(random_bytes(16)); // 32 —Å–∏–º–≤–æ–ª–∏
echo "–í–∞—à –ø–∞—Ä–æ–ª—å: $password\n";
echo "–•–µ—à: " . password_hash($password, PASSWORD_DEFAULT);
?>
```

–ó–±–µ—Ä–µ–∂—ñ—Ç—å –ø–∞—Ä–æ–ª—å –≤ –±–µ–∑–ø–µ—á–Ω–æ–º—É –º—ñ—Å—Ü—ñ (–º–µ–Ω–µ–¥–∂–µ—Ä –ø–∞—Ä–æ–ª—ñ–≤)!

### –†–µ–≥—É–ª—è—Ä–Ω—ñ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è

1. **PHP**: –ó–∞–≤–∂–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—É –≤–µ—Ä—Å—ñ—é
   - –ü–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ: https://www.php.net/supported-versions.php
   
2. **–ë–µ–∫–∞–ø–∏**: –†–æ–±—ñ—Ç—å —â–æ–¥–µ–Ω–Ω—ñ –±–µ–∫–∞–ø–∏
   ```bash
   cp data/blog.db backups/blog_$(date +%Y%m%d).db
   ```

3. **–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥—ñ–≤**: –ü–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ error.log –Ω–∞ –ø—ñ–¥–æ–∑—Ä—ñ–ª—É –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å

## –ó–≤—ñ—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–æ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ

–Ø–∫—â–æ –≤–∏ –∑–Ω–∞–π—à–ª–∏ –ø—Ä–æ–±–ª–µ–º—É –±–µ–∑–ø–µ–∫–∏:
1. **–ù–ï** —Å—Ç–≤–æ—Ä—é–π—Ç–µ –ø—É–±–ª—ñ—á–Ω–∏–π issue
2. –ù–∞–ø–∏—à—ñ—Ç—å –º–µ–Ω—ñ –ø—Ä–∏–≤–∞—Ç–Ω–æ –Ω–∞ [email]
3. –û–ø–∏—à—ñ—Ç—å –ø—Ä–æ–±–ª–µ–º—É –¥–µ—Ç–∞–ª—å–Ω–æ
4. –î–∞–π—Ç–µ —á–∞—Å –Ω–∞ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è (reasonable disclosure)

## –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∏–π —Å–ø–∏—Å–æ–∫ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º

- [ ] –ó–º—ñ–Ω–µ–Ω–æ –¥–µ—Ñ–æ–ª—Ç–Ω–∏–π –ø–∞—Ä–æ–ª—å
- [ ] –ü–∞—Ä–æ–ª—å —Ö–µ—à–æ–≤–∞–Ω–∏–π —á–µ—Ä–µ–∑ `password_hash()`
- [ ] –ü—Ä–∞–≤–∞ –Ω–∞ `data/` —Ç–∞ `uploads/` –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ (777)
- [ ] `.htaccess` –ø—Ä–∞—Ü—é—î (mod_rewrite —É–≤—ñ–º–∫–Ω–µ–Ω–æ)
- [ ] –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è XSS: —Å–ø—Ä–æ–±–∞ –≤–≤–µ—Å—Ç–∏ `<script>alert('xss')</script>`
- [ ] –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è CSRF: –≤–∏–¥–∞–ª–∏—Ç–∏ —Ç–æ–∫–µ–Ω –∑ —Ñ–æ—Ä–º–∏
- [ ] –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è: —Å–ø—Ä–æ–±–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ PHP —Ñ–∞–π–ª
- [ ] –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è SQL: —Å–ø—Ä–æ–±–∞ –≤–≤–µ—Å—Ç–∏ `'; DROP TABLE notes; --`
- [ ] HTTPS —É–≤—ñ–º–∫–Ω–µ–Ω–æ (—è–∫—â–æ –º–æ–∂–ª–∏–≤–æ)
- [ ] –ë–µ–∫–∞–ø –ë–î –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ
- [ ] Error logging —É–≤—ñ–º–∫–Ω–µ–Ω–æ, display_errors –≤–∏–º–∫–Ω–µ–Ω–æ

## –î–æ–¥–∞—Ç–∫–æ–≤—ñ —Ä–µ—Å—É—Ä—Å–∏

- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [PHP Security Guide](https://phptherightway.com/#security)
- [Content Security Policy](https://content-security-policy.com/)

---

**–ü–∞–º'—è—Ç–∞–π—Ç–µ**: –ë–µ–∑–ø–µ–∫–∞ - —Ü–µ –ø—Ä–æ—Ü–µ—Å, –∞ –Ω–µ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–∞ –¥—ñ—è. –†–µ–≥—É–ª—è—Ä–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ —Ç–∞ –æ–Ω–æ–≤–ª—é–π—Ç–µ —Å–≤—ñ–π –±–ª–æ–≥!
